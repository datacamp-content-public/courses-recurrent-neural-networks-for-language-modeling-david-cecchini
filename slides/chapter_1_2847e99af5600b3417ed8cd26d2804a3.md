---
title: Insert title here
key: 2847e99af5600b3417ed8cd26d2804a3

---
## Introduction to RNN inside keras

```yaml
type: "TitleSlide"
key: "a7bfabbdb4"
```

`@lower_third`

name: David Cecchini
title: Data Scientist, LegalBot & Demographics Pro


`@script`
In this lesson we are going to the practical implementation of the RNN models using keras.
Previously in this chapter we learned the architecture of the RNN cells, and now we will use keras to create and train RNN models.


---
## What is keras?

```yaml
type: "TwoRows"
key: "a6fc7ee15f"
```

`@part1`
Keras is a high-level API that can use Tensorflow, CNTK and Theano as background deep learning frameworks. 

Thus, in order to use keras, one of those frameworks should be installed (Tensorflow is used by default).


`@part2`
Easy to install and use: 

```
pip install keras
```

```
from keras.models import Sequential
from keras.layers import LSTM
```


`@script`



---
## Main keras modules

```yaml
type: "FullSlide"
key: "9fafe9f8fe"
```

`@part1`
**keras.models** contains the classes used to create and manage models: 
1. **Sequential** creates models where the next layer has the previous layer as input and the next layer as output
2. **Model** creates a generic model that can have multiple inputs and outputs (branches)

**keras.layers** contains the pre-defined layers available in keras:
1. **LSTM**, **GRU**, **Dense**, **Dropout**, **Embedding**, **Bidirectional**


`@script`



---
## Main keras modules (cont.)

```yaml
type: "TwoColumns"
key: "9d6fb85692"
```

`@part1`
**keras.preprocessing** has many functions for pre-processing the data

1. **sequence** contains the functions for pre-processing sequence data such as **pad_sequences**


`@part2`
**keras.datasets** contains many data science datasets ready to be loaded and used

1. **imdb** contains the famous movie reviews dataset for sentiment classification (binary)
2. **reuters** is another dataset for multi-class classification (46 topics of news articles)


`@script`



---
## Creating a model

```yaml
type: "FullSlide"
key: "d29b88e6ee"
```

`@part1`
It is easy to build a model in keras. Remarks:

1. The first layer (input layer) should specify the shape of the inputs
2. There are many activation functions to be used on each layer (or none, meaning that the layer will use identity function as activation)

A simple model with two dense layers:

```
from keras.models import Sequential
from keras.layers import Dense

model = Sequential()
model.add(Dense(64, activation='relu', input_dim=100))
model.add(Dense(1, activation='sigmoid'))
model.compile(optimizer='adam',
              loss='binary_crossentropy',
              metrics=['accuracy'])

```


`@script`



---
## Training the model

```yaml
type: "FullSlide"
key: "ca29abab37"
```

`@part1`
The method **fit** trains the model on the training set

```
model.fit(X_train, y_train, epochs=10, batch_size=32)
```

1. **epochs** determine how many weight updates will be done on the model
2. **batch_size** corresponds to the size of the data that will be used on each step to avoid memory errors (when the dataset cannot fit in the memory this is crucial)


`@script`



---
## Model evaluation and usage

```yaml
type: "FullSlide"
key: "f7bd2ea11c"
```

`@part1`
In order to analyze the model's performance, we can use the method **evaluate**.

```
mode.evaluate(X_test, y_test, batch_size=64)
```

The method **predict** is used on new data to obtain the outputs of the model.

```
model.predict(new_data, batch_size=64)
```


If **batch_size** is not specified, it will default to 32.


`@script`



---
## Full example: IMDB Sentiment Classification

```yaml
type: "FullCodeSlide"
key: "7220f319a5"
```

`@part1`
The IMDB dataset is already loaded and the X sequences padded with size = 80

```
from keras.models import Sequential
from keras.layers import Dense, Embedding, LSTM

# Build the model
model = Sequential()
model.add(Embedding(10000, 128))
model.add(LSTM(128, dropout=0.2))
model.add(Dense(1, activation='sigmoid'))

# Compile with binary_crossentropy for binary classification
model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

# Training
model.fit(x_train, y_train, epochs=15)

# Evaluation
score, acc = model.evaluate(x_test, y_test)

print('Test score: {0}\nTest accuracy: {1}'.format(score, acc))

```


`@script`



---
## Final Slide

```yaml
type: "FinalSlide"
key: "b9e39fe9e5"
```

`@script`


